% !TEX TS-program = pdfLaTeX
% !TEX encoding = UTF-8 unicode

\documentclass[11pt, a4paper, english]{article}

% Layout packages
\usepackage{changepage} %for margins
\usepackage{wrapfig} %for sidebars
\usepackage{tabularx} %for tables

\usepackage[noheadfoot,margin=1in]{geometry}
\setlength{\parindent}{0cm}
\setlength{\parskip}{2ex plus 0.5ex minus 0.2ex}


%Environment packages
\usepackage{graphicx} %for images
\usepackage{tcolorbox} %for background colours
\usepackage{hyperref} %for URLs

%usability packages
\usepackage{todonotes} %for keeping track
\usepackage[l2tabu, orthodox]{nag} %forces LaTeX commands

%Environments

\newenvironment{wrapbox}
	{
		\begin{wrapfigure}{R}{0.3\textwidth}
		\begin{tcolorbox}
	}
	{
		\end{tcolorbox}
		\end{wrapfigure}
	}



\begin{document}

\title{Git Well Soon: a crash course in version control}

\maketitle

Ciaran has a set of SAR tools he is maintaining using a Github source code repository; [LINK] Here’s how you can get that code for your own use, make any changes you feel are needed and share it with anyone else who would require it.

\underline{What is Git?}

Git is a way of managing and keeping track of a piece of software’s history – who made what change when. It is also a way combining code from multiple developers together into a single piece of software, while still keeping track of who did what.

\underline{Installing Git}

If you're on Windows, then you can install Git for Windows via the University’s Program Installer. If you're on an Ubuntu or other Linux machine, then Git is usually pre-installed. If not, then you can install it with

\begin{verbatim}
$ sudo apt-get install git-all
\end{verbatim}

on the command line.

\begin{wrapbox}
From here out, it’s assuming that you are using a standard Bash terminal for navigation. If you are on Windows, a good enough emulation comes with Git for Windows; just type ‘Git Bash’ into the search bar.
\end{wrapbox}

\begin{wrapbox}
If you’re not familiar with using a terminal to navigate, all you need for this session are the following commands: \verb|$cd [folder]| will move you into [folder]; \verb|$cd ..| will move you up to the parent folder; \verb|$ls| will show files in the current folder; and \verb|mkdir [name]| will create a new directory called [name].
\end{wrapbox}

\underline{Getting the code}

First, navigate to a convenient directory using cd and mkdir, as appropriate. Once there:

\begin{verbatim}

$git clone [LINK]

\end{verbatim}

This is now the \textbf{root} of your local repository – as far as Git is concerned, everything is relative to this point.

\missingfigure{diagram of clone}

\underline{What is happening here}

This will copy all of Ciaran’s code from Github to your machine into a \textbf{local repository}, complete with the history and branches [see later] of his project right to the beginning – you can view this with the command \verb|$ git log|. Press ‘q’ to exit the log viewer.

\underline{Why do this?}

As well as getting the entire project’s codebase, when you cloned the repository with \verb|$ git clone|, you also cloned its history and configuration. This means that you can:

\begin{itemize}
\item Keep it up to date with any revisions Ciaran might make in the future
\item Review any changes he might have made in the past, and understand why he made those changes.
\item If you make a huge, unfixable mistake, or if the code was working last Tuesday and isn’t now, you can roll the entire project back to a point where everything was working
\item Fix any bugs or glitches you might find
\item Add any further features that you think the code might need, and share those features with anyone else.
\end{itemize}

\underline{Keeping the code up-to-date}

Whenever Ciaran or anyone else makes a change or adds a new feature, you can easily update his code on your own machine with this command:

\begin{verbatim}
$git pull
\end{verbatim}

You should now see a short summary of what has been changed; you can get more information using the command \verb|git diff|, or see the later section on using graphical tools.

\textbf{IF YOU DO NOT WISH TO EDIT ANY CODE, YOU CAN STOP HERE.}

\underline{Editing code of your own}

Let’s say you wanted to add a function to Ciaran’s codebase. You’ve written the script – let’s call it [newthing] – in a file of its own (\verb|newthing.py|), and now you want to add it to Ciaran’s repository so everyone else can use it. This process has a few steps.

\begin{enumerate}
\item Put newthing.py in a sensible place in your local repository using a file manager. You can check it’s there with \verb|$git status|
As you might gather from the status message, Git does not know that you want to add newthing.py to the repository.
\item Use the command
\begin{verbatim}
$git add FILEPATH
\end{verbatim}
where \verb|FILEPATH| is the path from the root of your local repository. If in doubt, use the message that git status gives you.

This adds newthing.py to your staging area. This is where any changes you make are stored until you commit them to your local repository in the next step. Once a file is added to your staging area, it will stay there until deleted or explicitly removed; you do not need to keep [add]ing it.

\item Commit the changes to your local repository with the command
\begin{verbatim}
$git commit –m "some informative message here"
\end{verbatim}
The message you write in here is what will appear when anyone runs “git log”, so make sure it’s informative and clean(ish)
\begin{wrapbox} 
If you forget the –m option, by default Git will open vim; a powerful but non-intuitive text editor. To exit Vim, press ‘esc’ then type ‘:q!’ without the quotes. If you want to learn Vim, clear an hour in your schedule and run ‘vimtutor’ from the command line.
\end{wrapbox}
\begin{wrapbox} When to commit “Early and often” is the mantra from the community; the smaller each commit is, the more powerful the ‘time-travel’ tools below become. Find a commit pace that works for you, but if in doubt more often is usually better.
\end{wrapbox}
This commits snapshots of your code to your local repository; 
\item Continue to edit and \verb|git commit| your code, using [add] to add new files as required. Bear in mind none of these changes will go to Ciaran’s repository yet.
\item Once you are happy with your new feature and are reasonably sure that it doesn’t break anything else, use the command
\begin{verbatim}
$git push
\end{verbatim}
to put your changes into Cieron’s repository. You might be prompted for your Github username and password here.
\end{enumerate}

\begin{wrapbox} 
When you're doing a large commit (such as adding a new feature to a repo), it’s good to write a longer commit message using a text editor – the default is Vim, but you can change this using the command git config –global core.editor [editor]. For a quick guide to writing useful commit messages, see \url{https://chris.beams.io/posts/git-commit/}.
\end{wrapbox}

\underline{Branching}

It is a sad fact that when working on improving a piece of code, you will almost certainly break it or something else instead. To avoid this and the associated recriminations, Git allows you to make local timelines of the project that you can mess around with as you please, without affecting anyone else’s work. These local timelines are called ‘branches’.

By convention, each Git repository starts with a branch called ‘master’. Once the initial code repository is written, this is usually the 'this code works' branch – anyone wanting to use Cieran’s tools will use the code stored in ‘master’. 

\textbf{It is good practice whenever you are writing a new feature to create a branch to develop it in.} This way, others can still use the original version of the program and also contribute to your improved version, and you can test your new features without having to worry about breaking the software for everyone.

To create a new branch, use the command

\begin{verbatim}
$git branch [branchname]
\end{verbatim}

to  create the branch, and the command

\begin{verbatim}
$git checkout [branchname]
\end{verbatim}

to start work in the new branch. As long as you have commited your work, you can move between branches with the \verb|$git checkout| command and see the difference between them with \verb|$git diff [branch1] [branch2]|.

This branch is in your \textbf{local repository}. If you \verb|$ git push| while you’re working in a branch, Git will add that branch to the \textbf{remote repository} for others to access.

\underline{Merging}

Merging is when you take the changes made in one branch and apply them to another branch. Git is very smart about this, and changes are done more or less line-by-line - even if two people are working on different parts of the same file in different branches, Git can collate those changes without user input (but see the next section). There are two situations where you need to merge regularly;

\begin{itemize}
\item \underline{When you have finished work on a branch:} You will want to merge your shiny new feature into the ‘master’ branch, so everyone can use it. To do this, first make sure you have \verb|$ git commit|ed your changes to your branch. Then, move to the ‘master’ branch using
\begin{verbatim}
$git checkout master
\end{verbatim}
Once there, use the command
\begin{verbatim}
$ git merge [branchname]
\end{verbatim}

This will bring the changes out have made in [branchname] into the 'master' branch; you can then push that branch to the remote repository using \verb|$ git push|.



\end{document}

